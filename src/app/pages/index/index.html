<div class="card col-6 mx-auto mt-5 shadow rounded-4">
  <div class="card-body p-3">
    <h2 class="text-center">
      Lista de usuarios
    </h2>

    <div class="mb-4 p-3 border rounded-3 bg-light" [formGroup]="usuarioForm">
      <h3 class="fs-5 text-primary text-center">
        @if (selectedUserId()) {
        Editar Usuario (ID: {{ selectedUserId() }})
        } @else {
        Agregar Nuevo Usuario
        }
      </h3>

      <div class="row g-3">
        <div class="col-md-4">
          <input type="text" class="form-control" formControlName="nombre" placeholder="Nombre" />
        </div>
        <div class="col-md-4">
          <input type="email" class="form-control" formControlName="email" placeholder="Email" />
        </div>
        <div class="col-md-4">
          <input type="text" class="form-control" formControlName="numero" placeholder="NÃºmero" />
        </div>
      </div>

      <div class="d-flex justify-content-end gap-2 mt-3">

        <button class="btn btn-primary" (click)="guardarUsuario()" [disabled]="usuarioForm.invalid">
          @if (selectedUserId()) {
          Guardar Cambios
          } @else {
          Agregar Usuario
          }
        </button>

        <button class="btn btn-secondary" (click)="resetForm()">
          Cancelar
        </button>
      </div>
    </div>

    @if (isLoading()) {
    <p>Cargando Usuarios...</p>
    }

    @if (error()) {
    <div style="color:red; border:1px solid red; padding:10px;">
      <p>Error al cargar usuarios. Intenta de nuevo.</p>
    </div>
    }

    @if (usuarios().length > 0 && !isLoading()) {
    <table class="table table-responsive table-rounded table-striped table-hover mt-5">
      <thead>
        <tr>
          <th>ID</th>
          <th>Nombre</th>
          <th>Email</th>
          <th>Numero</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        @for (usuario of usuarios(); track usuario.id) {
        <tr>
          <td>{{ usuario.id }}</td>
          <td>{{ usuario.nombre }}</td>
          <td>{{ usuario.email }}</td>
          <td>{{ usuario.numero }}</td>
          <td>
            <button class="btn btn-sm btn-info me-2" (click)="seleccionarUsuario(usuario)">Editar</button>
            <button class="btn btn-sm btn-danger" (click)="eliminarUsuario(usuario.id)">Eliminar</button>
          </td>
        </tr>
        }
      </tbody>
    </table>

    } @else if(!isLoading() && !error()) {
    <p>No se encontraron usuarios</p>
    }
  </div>
</div>
